(()=>{var e={};e.id=105,e.ids=[105],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},2412:e=>{"use strict";e.exports=require("assert")},5511:e=>{"use strict";e.exports=require("crypto")},4735:e=>{"use strict";e.exports=require("events")},9021:e=>{"use strict";e.exports=require("fs")},1630:e=>{"use strict";e.exports=require("http")},5591:e=>{"use strict";e.exports=require("https")},1820:e=>{"use strict";e.exports=require("os")},3873:e=>{"use strict";e.exports=require("path")},7910:e=>{"use strict";e.exports=require("stream")},3997:e=>{"use strict";e.exports=require("tty")},9551:e=>{"use strict";e.exports=require("url")},8354:e=>{"use strict";e.exports=require("util")},4075:e=>{"use strict";e.exports=require("zlib")},1002:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>c});var r=t(260),a=t(8203),i=t(5155),n=t.n(i),o=t(7292),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2155)),"/Users/admin/Documents/1 Projects/KreditScore4/frontend/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9611)),"/Users/admin/Documents/1 Projects/KreditScore4/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,1485,23)),"next/dist/client/components/unauthorized-error"]}],d=["/Users/admin/Documents/1 Projects/KreditScore4/frontend/app/dashboard/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5380:(e,s,t)=>{Promise.resolve().then(t.bind(t,2155))},3940:(e,s,t)=>{Promise.resolve().then(t.bind(t,1326))},3347:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,3219,23)),Promise.resolve().then(t.t.bind(t,4863,23)),Promise.resolve().then(t.t.bind(t,5155,23)),Promise.resolve().then(t.t.bind(t,802,23)),Promise.resolve().then(t.t.bind(t,9350,23)),Promise.resolve().then(t.t.bind(t,8530,23)),Promise.resolve().then(t.t.bind(t,8921,23))},299:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,6959,23)),Promise.resolve().then(t.t.bind(t,3875,23)),Promise.resolve().then(t.t.bind(t,8903,23)),Promise.resolve().then(t.t.bind(t,7174,23)),Promise.resolve().then(t.t.bind(t,4178,23)),Promise.resolve().then(t.t.bind(t,7190,23)),Promise.resolve().then(t.t.bind(t,1365,23))},1447:()=>{},4591:()=>{},1326:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(5512),a=t(8009),i=t(9334),n=t(3567),o=t(8957);function l({className:e=""}){let[s,t]=(0,a.useState)(null),[i,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),p=async()=>{try{x(!0),h(null);let[e,s,r]=await Promise.all([n.i$.getMe(),n.i$.getMySessions(),n.i$.getDeviceInfo()]);t(e),l(s),d(r)}catch(e){console.error("Ошибка загрузки данных:",e),h("Не удалось загрузить данные пользователя")}finally{x(!1)}},g=async()=>{confirm("Вы уверены, что хотите выйти?")&&await (0,o.ri)()},j=e=>new Date(e).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return m?(0,r.jsx)("div",{className:`card animate-pulse ${e}`,children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})}):u?(0,r.jsx)("div",{className:`card border-red-200 bg-red-50 ${e}`,children:(0,r.jsxs)("div",{className:"text-red-600 text-center",children:[(0,r.jsx)("p",{className:"font-medium",children:"Ошибка"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:u}),(0,r.jsx)("button",{onClick:p,className:"mt-3 btn-secondary text-sm",children:"Попробовать снова"})]})}):s?(0,r.jsxs)("div",{className:`space-y-6 ${e}`,children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Профиль пользователя"}),(0,r.jsx)("button",{onClick:g,className:"btn-secondary text-sm",children:"Выйти"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Телефон"}),(0,r.jsx)("p",{className:"text-lg text-gray-900",children:s.phone_number})]}),s.first_name&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Имя"}),(0,r.jsx)("p",{className:"text-lg text-gray-900",children:s.first_name})]}),s.last_name&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Фамилия"}),(0,r.jsx)("p",{className:"text-lg text-gray-900",children:s.last_name})]}),s.username&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Username"}),(0,r.jsxs)("p",{className:"text-lg text-gray-900",children:["@",s.username]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Telegram ID"}),(0,r.jsx)("p",{className:"text-lg text-gray-900 font-mono",children:s.telegram_id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Дата регистрации"}),(0,r.jsx)("p",{className:"text-lg text-gray-900",children:j(s.created_at)})]})]})]}),c&&(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Информация об устройстве"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"IP адрес"}),(0,r.jsx)("p",{className:"text-lg text-gray-900 font-mono",children:c.ip_address})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Устройство"}),(0,r.jsx)("p",{className:"text-lg text-gray-900",children:c.device_info})]})]})]}),i.length>0&&(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Активные сессии (",i.filter(e=>e.is_active).length,")"]}),(0,r.jsx)("div",{className:"space-y-3",children:i.filter(e=>e.is_active).map(e=>(0,r.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg border",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-500",children:"IP:"}),(0,r.jsx)("span",{className:"ml-2 font-mono",children:e.ip_address})]}),e.device_info&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-500",children:"Устройство:"}),(0,r.jsx)("span",{className:"ml-2",children:e.device_info})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-500",children:"Вход:"}),(0,r.jsx)("span",{className:"ml-2",children:j(e.created_at)})]})]})},e.id))})]})]}):null}function c(){return((0,i.useRouter)(),(0,o.wR)())?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Управление вашими данными и сессиями"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"hidden sm:block text-sm text-gray-500",children:"Добро пожаловать в KreditScore4"}),(0,r.jsx)("div",{className:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})]})})}),(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)(l,{})})]}):null}},3567:(e,s,t)=>{"use strict";t.d(s,{ZQ:()=>n,i$:()=>o});var r=t(5668),a=t(5998);let i=r.A.create({baseURL:"http://localhost:8000",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let s=a.A.get("access_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e}),i.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(a.A.remove("access_token"),window.location.href="/"),Promise.reject(e)));let n={createAuthToken:async()=>(await i.post("/api/auth/create-token")).data,checkAuthStatus:async e=>(await i.post("/api/auth/verify",{auth_token:e})).data,async logout(){await i.post("/api/auth/logout"),a.A.remove("access_token")}},o={getMe:async()=>(await i.get("/api/users/me")).data,getMySessions:async()=>(await i.get("/api/users/me/sessions")).data,getDeviceInfo:async()=>(await i.get("/api/users/me/device-info")).data}},8957:(e,s,t)=>{"use strict";t.d(s,{KM:()=>c,Wp:()=>l,mn:()=>o,ri:()=>n,wR:()=>i});var r=t(5998),a=t(3567);function i(){return!!r.A.get("access_token")}async function n(){try{await a.ZQ.logout()}catch(e){console.error("Ошибка при выходе:",e)}finally{r.A.remove("access_token"),window.location.href="/"}}function o(){return null}async function l(){try{let{telegram_url:e}=await a.ZQ.createAuthToken();window.location.href=e}catch(e){throw console.error("Ошибка при создании токена авторизации:",e),Error("Не удалось начать авторизацию")}}async function c(e){try{var s;let t=await a.ZQ.checkAuthStatus(e);return s=t.access_token,r.A.set("access_token",s,{expires:7,secure:!0,sameSite:"strict"}),t.user}catch(e){throw console.error("Ошибка при завершении авторизации:",e),Error("Не удалось завершить авторизацию")}}},2155:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/admin/Documents/1 Projects/KreditScore4/frontend/app/dashboard/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/admin/Documents/1 Projects/KreditScore4/frontend/app/dashboard/page.tsx","default")},9611:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l,metadata:()=>n,viewport:()=>o});var r=t(2740),a=t(9258),i=t.n(a);t(2704);let n={title:"KreditScore4",description:"Авторизация через Telegram Bot"},o={width:"device-width",initialScale:1,themeColor:"#3b82f6"};function l({children:e}){return(0,r.jsxs)("html",{lang:"ru",children:[(0,r.jsxs)("head",{children:[(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,r.jsx)("link",{rel:"manifest",href:"/manifest.json"})]}),(0,r.jsx)("body",{className:`${i().className} bg-gray-50 min-h-screen`,children:(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)("main",{className:"flex-1",children:e}),(0,r.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4",children:(0,r.jsx)("div",{className:"container mx-auto px-4 text-center text-sm text-gray-600",children:"\xa9 2024 KreditScore4. Все права защищены."})})]})})]})}},2704:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[720,338],()=>t(1002));module.exports=r})();